<!DOCTYPE html><html lang="zh"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style id="typography.js">html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,main,menu,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block}audio:not([controls]){display:none;height:0}progress{vertical-align:baseline}[hidden],template{display:none}a{background-color:transparent;-webkit-text-decoration-skip:objects}a:active,a:hover{outline-width:0}abbr[title]{border-bottom:none;text-decoration:underline;text-decoration:underline dotted}b,strong{font-weight:inherit;font-weight:bolder}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background-color:#ff0;color:#000}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}svg:not(:root){overflow:hidden}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}figure{margin:1em 40px}hr{box-sizing:content-box;height:0;overflow:visible}button,input,optgroup,select,textarea{font:inherit;margin:0}optgroup{font-weight:700}button,input{overflow:visible}button,select{text-transform:none}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-cancel-button,[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-input-placeholder{color:inherit;opacity:.54}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{font:100%/1.625 -apple-system,'BlinkMacSystemFont','Segoe UI','Roboto','Helvetica','Arial',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol';box-sizing:border-box;overflow-y:scroll;}*{box-sizing:inherit;}*:before{box-sizing:inherit;}*:after{box-sizing:inherit;}body{color:hsla(0,0%,0%,0.8);font-family:-apple-system,'BlinkMacSystemFont','Segoe UI','Roboto','Helvetica','Arial',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol';font-weight:normal;word-wrap:break-word;font-kerning:normal;-moz-font-feature-settings:"kern", "liga", "clig", "calt";-ms-font-feature-settings:"kern", "liga", "clig", "calt";-webkit-font-feature-settings:"kern", "liga", "clig", "calt";font-feature-settings:"kern", "liga", "clig", "calt";}img{max-width:100%;margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;}h1{margin-left:0;margin-right:0;margin-top:2.4375rem;padding-bottom:calc(0.40625rem - 1px);padding-left:0;padding-right:0;padding-top:0;margin-bottom:1.21875rem;color:inherit;font-family:-apple-system,'BlinkMacSystemFont','Segoe UI','Roboto','Helvetica','Arial',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol';font-weight:600;text-rendering:optimizeLegibility;font-size:2rem;line-height:1.1;border-bottom:1px solid hsla(0,0%,0%,0.07);}h2{margin-left:0;margin-right:0;margin-top:1.625rem;padding-bottom:calc(0.40625rem - 1px);padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.40625rem;color:inherit;font-family:-apple-system,'BlinkMacSystemFont','Segoe UI','Roboto','Helvetica','Arial',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol';font-weight:600;text-rendering:optimizeLegibility;font-size:1.51572rem;line-height:1.1;border-bottom:1px solid hsla(0,0%,0%,0.07);}h3{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;color:inherit;font-family:-apple-system,'BlinkMacSystemFont','Segoe UI','Roboto','Helvetica','Arial',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol';font-weight:600;text-rendering:optimizeLegibility;font-size:1.31951rem;line-height:1.1;}h4{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;color:inherit;font-family:-apple-system,'BlinkMacSystemFont','Segoe UI','Roboto','Helvetica','Arial',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol';font-weight:600;text-rendering:optimizeLegibility;font-size:1rem;line-height:1.1;}h5{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;color:inherit;font-family:-apple-system,'BlinkMacSystemFont','Segoe UI','Roboto','Helvetica','Arial',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol';font-weight:600;text-rendering:optimizeLegibility;font-size:0.87055rem;line-height:1.1;}h6{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;color:hsla(0,0%,0%,0.53);font-family:-apple-system,'BlinkMacSystemFont','Segoe UI','Roboto','Helvetica','Arial',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol';font-weight:600;text-rendering:optimizeLegibility;font-size:0.81225rem;line-height:1.1;}hgroup{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;}ul{margin-left:1.625rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;list-style-position:outside;list-style-image:none;}ol{margin-left:1.625rem;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;list-style-position:outside;list-style-image:none;}dl{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;}dd{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;}p{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;}figure{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;}pre{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;font-size:0.85rem;line-height:1.625rem;}table{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;font-size:1rem;line-height:1.625rem;border-collapse:collapse;width:100%;}fieldset{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;}blockquote{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:calc(0.8125rem - 1px);padding-right:0;padding-top:0;margin-bottom:0.8125rem;border-left:4px solid hsla(0,0%,0%,0.13);color:hsla(0,0%,0%,0.53);}form{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;}noscript{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;}iframe{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;}hr{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:calc(0.8125rem - 1px);background:hsla(0,0%,0%,0.2);border:none;height:1px;}address{margin-left:0;margin-right:0;margin-top:0;padding-bottom:0;padding-left:0;padding-right:0;padding-top:0;margin-bottom:0.8125rem;}b{font-weight:600;}strong{font-weight:600;}dt{font-weight:600;}th{font-weight:600;}li{margin-bottom:calc(0.8125rem / 2);}ol li{padding-left:0;}ul li{padding-left:0;}li > ol{margin-left:1.625rem;margin-bottom:calc(0.8125rem / 2);margin-top:calc(0.8125rem / 2);}li > ul{margin-left:1.625rem;margin-bottom:calc(0.8125rem / 2);margin-top:calc(0.8125rem / 2);}blockquote *:last-child{margin-bottom:0;}li *:last-child{margin-bottom:0;}p *:last-child{margin-bottom:0;}li > p{margin-bottom:calc(0.8125rem / 2);}code{font-size:0.85rem;line-height:1.625rem;}kbd{font-size:0.85rem;line-height:1.625rem;}samp{font-size:0.85rem;line-height:1.625rem;}abbr{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}acronym{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;}abbr[title]{border-bottom:1px dotted hsla(0,0%,0%,0.5);cursor:help;text-decoration:none;}thead{text-align:left;}td,th{text-align:left;border-bottom:1px solid hsla(0,0%,0%,0.12);font-feature-settings:"tnum";-moz-font-feature-settings:"tnum";-ms-font-feature-settings:"tnum";-webkit-font-feature-settings:"tnum";padding-left:1.08333rem;padding-right:1.08333rem;padding-top:0.8125rem;padding-bottom:calc(0.8125rem - 1px);}th:first-child,td:first-child{padding-left:0;}th:last-child,td:last-child{padding-right:0;}h3,h4,h5,h6{margin-bottom:0.8125rem;margin-top:1.625rem;}ol,ul{margin-left:2.03125rem;}li>ol,li>ul{margin-left:2.03125rem;}a{color:#4078c0;text-decoration:none;}a:hover,a:active{text-decoration:underline;}</style><title data-react-helmet="true">函数式编程进阶：应用函子 | 云音乐大前端专栏</title><style type="text/css">.gatsby-resp-image-image{width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;color:transparent;}</style><link rel="preconnect dns-prefetch" href="https://www.google-analytics.com"/><link rel="alternate" type="application/rss+xml" href="/rss.xml"/><link rel="shortcut icon" href="/icons/icon-48x48.png?v=d8c4c3e0da7a96b81c222f3b61a1543f"/><link rel="manifest" href="/manifest.webmanifest"/><meta name="theme-color" content="#dd001b"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=d8c4c3e0da7a96b81c222f3b61a1543f"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=d8c4c3e0da7a96b81c222f3b61a1543f"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=d8c4c3e0da7a96b81c222f3b61a1543f"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=d8c4c3e0da7a96b81c222f3b61a1543f"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=d8c4c3e0da7a96b81c222f3b61a1543f"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=d8c4c3e0da7a96b81c222f3b61a1543f"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=d8c4c3e0da7a96b81c222f3b61a1543f"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=d8c4c3e0da7a96b81c222f3b61a1543f"/><meta name="generator" content="Gatsby 2.15.7"/><meta data-react-helmet="true" name="description" content="当你开始学习函数式编程的时候，你肯定听说过“纯函数”，“副作用”，“柯里化”等概念，本章将从这些基础概念入手开始，开始讲解把一个函数装进 “Box” 中的理念，然后引出“应用函子”的概念，并给出实际的应用案例。"/><meta data-react-helmet="true" property="og:title" content="函数式编程进阶：应用函子"/><meta data-react-helmet="true" property="og:description" content="当你开始学习函数式编程的时候，你肯定听说过“纯函数”，“副作用”，“柯里化”等概念，本章将从这些基础概念入手开始，开始讲解把一个函数装进 “Box” 中的理念，然后引出“应用函子”的概念，并给出实际的应用案例。"/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:creator" content="云音乐大前端团队"/><meta data-react-helmet="true" name="twitter:title" content="函数式编程进阶：应用函子"/><meta data-react-helmet="true" name="twitter:description" content="当你开始学习函数式编程的时候，你肯定听说过“纯函数”，“副作用”，“柯里化”等概念，本章将从这些基础概念入手开始，开始讲解把一个函数装进 “Box” 中的理念，然后引出“应用函子”的概念，并给出实际的应用案例。"/><style data-href="/styles.a8f6e12462010344bfaf.css">@font-face{font-family:Source Code Pro;font-style:normal;font-display:swap;font-weight:200;src:local("Source Code Pro Extra Light "),local("Source Code Pro-Extra Light"),url(/static/source-code-pro-latin-200-41568fe7927570e049a6cb707930f353.woff2) format("woff2"),url(/static/source-code-pro-latin-200-568dcb298a36f14317fdcddf8eded62f.woff) format("woff")}@font-face{font-family:Source Code Pro;font-style:normal;font-display:swap;font-weight:300;src:local("Source Code Pro Light "),local("Source Code Pro-Light"),url(/static/source-code-pro-latin-300-248b2236ba6bb9d2745a4908bc9c4568.woff2) format("woff2"),url(/static/source-code-pro-latin-300-43fcfcf552695ff0976d7d03a29835c4.woff) format("woff")}@font-face{font-family:Source Code Pro;font-style:normal;font-display:swap;font-weight:400;src:local("Source Code Pro Regular "),local("Source Code Pro-Regular"),url(/static/source-code-pro-latin-400-1c37ab07cfefc70a85445f49737ad28a.woff2) format("woff2"),url(/static/source-code-pro-latin-400-a4a08973559a45aba173184ea065addf.woff) format("woff")}@font-face{font-family:Source Code Pro;font-style:normal;font-display:swap;font-weight:500;src:local("Source Code Pro Medium "),local("Source Code Pro-Medium"),url(/static/source-code-pro-latin-500-67f6c1995acae33eacb1af1807c0e8c8.woff2) format("woff2"),url(/static/source-code-pro-latin-500-a39fc2de145c00ef5898c77b15c27517.woff) format("woff")}@font-face{font-family:Source Code Pro;font-style:normal;font-display:swap;font-weight:600;src:local("Source Code Pro SemiBold "),local("Source Code Pro-SemiBold"),url(/static/source-code-pro-latin-600-bf5d453754c3bd3e0fc9bcdc979048f1.woff2) format("woff2"),url(/static/source-code-pro-latin-600-c021e440e993ff26de945242222960a6.woff) format("woff")}@font-face{font-family:Source Code Pro;font-style:normal;font-display:swap;font-weight:700;src:local("Source Code Pro Bold "),local("Source Code Pro-Bold"),url(/static/source-code-pro-latin-700-b46da14cbd07b2f1f5ca74069d59318e.woff2) format("woff2"),url(/static/source-code-pro-latin-700-c86a17b160684a125455d36f4733ad85.woff) format("woff")}@font-face{font-family:Source Code Pro;font-style:normal;font-display:swap;font-weight:900;src:local("Source Code Pro Black "),local("Source Code Pro-Black"),url(/static/source-code-pro-latin-900-e985b6f17d53c2780c3c49722984a52e.woff2) format("woff2"),url(/static/source-code-pro-latin-900-b0d773d996cad7ea914d35d16dd0f3ec.woff) format("woff")}@font-face{font-family:Noto Sans;font-style:normal;font-display:swap;font-weight:400;src:local("Noto Sans Regular "),local("Noto Sans-Regular"),url(/static/noto-sans-latin-400-175853ded2a4e2249d37c46ca0ca33c5.woff2) format("woff2"),url(/static/noto-sans-latin-400-e7ccb0aa43af9fb7fae4d1bdc23a099b.woff) format("woff")}@font-face{font-family:Noto Sans;font-style:italic;font-display:swap;font-weight:400;src:local("Noto Sans Regular italic"),local("Noto Sans-Regularitalic"),url(/static/noto-sans-latin-400italic-baa3ec09eb827b4f10593032d1cf2a88.woff2) format("woff2"),url(/static/noto-sans-latin-400italic-14425b1ebbce551302a950b083b6c14e.woff) format("woff")}@font-face{font-family:Noto Sans;font-style:normal;font-display:swap;font-weight:700;src:local("Noto Sans Bold "),local("Noto Sans-Bold"),url(/static/noto-sans-latin-700-43750a193b8ff0b4e929323a72d79301.woff2) format("woff2"),url(/static/noto-sans-latin-700-a8edfe7bbf3b01666adc30c118cc5223.woff) format("woff")}@font-face{font-family:Noto Sans;font-style:italic;font-display:swap;font-weight:700;src:local("Noto Sans Bold italic"),local("Noto Sans-Bolditalic"),url(/static/noto-sans-latin-700italic-bc98820a9bf62004a88ef07e012e3ce3.woff2) format("woff2"),url(/static/noto-sans-latin-700italic-0e19737ff39f96eb1ff99e463fa457a4.woff) format("woff")}code[class*=language-],pre[class*=language-]{color:#ccc;background:none;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:1em;margin:.5em 0;overflow:auto}:not(pre)>code[class*=language-],pre[class*=language-]{background:#2d2d2d}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.block-comment,.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#999}.token.punctuation{color:#ccc}.token.attr-name,.token.deleted,.token.namespace,.token.tag{color:#e2777a}.token.function-name{color:#6196cc}.token.boolean,.token.function,.token.number{color:#f08d49}.token.class-name,.token.constant,.token.property,.token.symbol{color:#f8c555}.token.atrule,.token.builtin,.token.important,.token.keyword,.token.selector{color:#cc99cd}.token.attr-value,.token.char,.token.regex,.token.string,.token.variable{color:#7ec699}.token.entity,.token.operator,.token.url{color:#67cdcc}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.token.inserted{color:green}</style><link as="script" rel="preload" href="/styles-b1c08a8a0eed6b686afc.js"/><link as="script" rel="preload" href="/component---src-templates-blog-post-js-788c454dbed28c00f3b8.js"/><link as="script" rel="preload" href="/app-0c9a63a3aef9e813df5b.js"/><link as="script" rel="preload" href="/commons-8d9941e7328683a5eecb.js"/><link as="script" rel="preload" href="/webpack-runtime-2742ada98d46151d1c6f.js"/><link as="fetch" rel="preload" href="/page-data/javascript-functional-programming-functor/page-data.json" crossorigin="anonymous"/></head><body><noscript id="gatsby-noscript">This app works best with JavaScript enabled.</noscript><div id="___gatsby"><div style="outline:none" tabindex="-1" role="group" id="gatsby-focus-wrapper"><div style="margin-left:auto;margin-right:auto;max-width:39rem;padding:2.4375rem 1.21875rem;font-family:&quot;Source Code Pro&quot;, &quot;Noto Sans CJK SC&quot;"><header><h1 style="font-size:2.2974rem;line-height:3.25rem;margin-top:0"><a style="box-shadow:none;text-decoration:none;color:#DD001B" href="/">云音乐大前端专栏</a></h1></header><main><article><header><h1 style="margin-top:1.625rem;margin-bottom:0;color:#001E26">函数式编程进阶：应用函子</h1><p style="font-size:0.87055rem;line-height:1.625rem;display:block;margin-bottom:1.625rem">2020-11-06</p></header><section><p><img src="https://p6.music.126.net/obj/wo3DlcOGw6DClTvDisK1/4602192261/a2a1/eb82/07ae/9ebb494ff96b26c7ae6ab0366663da51.png" alt="pipeline &#x26; function compose"></p>
<p>图片来源: <a href="https://unsplash.com/photos/FqYMtQpE77E">https://unsplash.com/photos/FqYMtQpE77E</a></p>
<blockquote>
<p>本文作者：<a href="https://github.com/sylvenas">赵祥涛</a></p>
</blockquote>
<p><a href="https://musicfe.dev/javascript-functional-programming-advance/">上一章</a>中介绍了 <code class="language-text">Functor(函子)</code> 的概念，简单来说，就是把一个 “value” 填装进 “Box” 中，继而可以使用 <code class="language-text">map</code> 方法映射变换 Box 中的值：<code class="language-text">Box(1).map(x =&gt; x+1)</code>。本章我们在继续在 <code class="language-text">Box</code> 的基础上继续扩展其他更强大的理念，从<a href="https://en.wikipedia.org/wiki/Pure_function">纯函数</a>与<a href="https://en.wikipedia.org/wiki/Side_effect_(computer_science)">副作用</a>的概念及用途作为承上启下的开端，继续巩固 <code class="language-text">Functor</code> 的概念以及接下来将要介绍的 <code class="language-text">Applicative Functor</code> 的引子。</p>
<p>函数式编程中纯函数是一个及其重要的概念，甚至可以说是函数组合的基础。你可能已经听过类似的言论：“纯函数是引用透明( Referential Transparency )的”，“纯函数是无副作用( Side Effect )的”，“纯函数没有共享状态( Shared State )”。下面简单介绍下纯函数。</p>
<h3>纯函数与副作用</h3>
<p>在计算机编程中，假如满足下面这两个条件的约束，一个函数可以被描述为一个“纯函数”( pure function )</p>
<ul>
<li>给出相同的参数，那么函数的返回值一定相同。该函数结果值不依赖任何隐藏信息或程序执行处理可能改变的状态，也不能依赖于任何来自 I/O 的外部输入。</li>
<li>在对函数返回值的计算过程中，不会产生任何语义上可观察的副作用或输出，例如对象的变化或者输出到 I/O 的操作。</li>
</ul>
<p>关于纯函数的第一条很简单，相同的输入，总会返回相同的输出，和中学数学中学习的“函数”完全类似，传入相同的参数，返回值一定相同，函数本身就是从集合到集合的“映射”。</p>
<p>第二条不产生可观察的副作用又是什么意思呢？也就是函数不可以和系统的其他部分通信。比如：打印日志，读写文件，数据请求，数据存储等等；</p>
<p>从代码编写者的角度来看，如果一段程序运行之后没有可观察到的作用，那他到底运行了没有？或者运行之后有没有实现代码的目的？有可能它只是浪费了几个 CPU 周期之后就去睡大觉了！</p>
<p>从 JavaScript 语言的诞生之初就不可避免地需要能够与不断变化的，共享的，有状态的 DOM 互相作用；如果无法输入输出任何数据，那么数据库有什么用处呢？如果无法从网络请求信息，我们的页面又该如何展示？没有 “side effect” 我们几乎寸步难行，<strong>副作用不可避免</strong>，上述的任何一个操作，都会产生副作用，违反了引用透明性，我们似乎陷入了两难的境地！</p>
<blockquote>
<p>世間安得雙全法，不負如來不負卿</p>
</blockquote>
<p><strong>如何在 <code class="language-text">keep pure</code> 的前提下，又能妥善的处理 <code class="language-text">side effect</code> 呢？</strong></p>
<h3>惰性盒子-LazyBox</h3>
<p>要想较理想的解决这个问题，我们把注意力转回到 JavaScript 的核心 function 上，我们知道在 JavaScript 里，函数是“一等公民”，JavaScript 允许开发人员像操作变量一样操作函数，例如将函数赋值给变量、把函数作为参数传递给其他函数、函数作为另一个函数的返回值，等等...</p>
<p>JavaScript 函数具有<strong>值的行为</strong>，也就是说，函数就是一个基于输入的且尚未求值的不可变的值，或者可以认为函数本身就是一个等待计算的惰性的值。那么我们完全可以把这个“惰性的值”装入 <code class="language-text">Box</code> 中，然后延迟调用即可，仿照上一章的 <code class="language-text">Box</code> ，可以实现一个 <code class="language-text">Lazy Box</code> ：</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">LazyBox</span> <span class="token operator">=</span> <span class="token parameter">g</span> <span class="token operator">=></span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token function-variable function">map</span><span class="token punctuation">:</span> <span class="token parameter">f</span> <span class="token operator">=></span> <span class="token function">LazyBox</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token function">g</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function-variable function">fold</span><span class="token punctuation">:</span> <span class="token parameter">f</span> <span class="token operator">=></span> <span class="token function">f</span><span class="token punctuation">(</span><span class="token function">g</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre></div>
<p>注意观察，<strong>map 函数所做的一直都是在组合函数，函数并没有被实际的调用；而调用 fold 函数才会真正的执行函数调用</strong>，看例子：</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">finalPrice</span> <span class="token operator">=</span> <span class="token parameter">str</span> <span class="token operator">=></span>
    <span class="token function">LazyBox</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> str<span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">x</span> <span class="token operator">=></span> <span class="token punctuation">{</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'str:'</span><span class="token punctuation">,</span> str<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">return</span> x <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">x</span> <span class="token operator">=></span> x <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">x</span> <span class="token operator">=></span> x <span class="token operator">*</span> <span class="token number">0.8</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">x</span> <span class="token operator">=></span> x <span class="token operator">-</span> <span class="token number">50</span><span class="token punctuation">)</span>  

<span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token function">finalPrice</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>  <span class="token comment">// => { map: [Function: map], fold: [Function: fold] }</span></code></pre></div>
<p>在调用 <code class="language-text">finalPrice</code> 函数的时候，并没有打印出 <code class="language-text">&#39;str:100&#39;</code>，说明正如我们预期的那样，函数并没有真正的被调用，而只是在不断的进行函数组合。在没有调用 <code class="language-text">fold</code> 函数之前，我们的代码都是 "pure" 的。</p>
<blockquote>
<p>这有点类似于递归，在未满足终止条件之前(没有调用 <code class="language-text">fold</code> 之前)，递归调用会在栈中不断的堆叠(组合函数)，直到满足终止条件(调用 <code class="language-text">fold</code> 函数)，才开始真正的函数计算。</p>
</blockquote>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">finalPrice</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> res2 <span class="token operator">=</span> app<span class="token punctuation">.</span><span class="token function">fold</span><span class="token punctuation">(</span><span class="token parameter">x</span> <span class="token operator">=></span> x<span class="token punctuation">)</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res2<span class="token punctuation">)</span> <span class="token comment">// => 110</span></code></pre></div>
<p><code class="language-text">fold</code> 函数就像打开潘多拉魔盒的双手；通过 <code class="language-text">LazyBox</code> 我们把可能会“弄脏双手(产生副作用)”的代码扔给了最后的 <code class="language-text">fold</code> ，这样做又有什么意义呢？</p>
<ul>
<li>把代码中不纯的部分剥离出来，保障核心部分代码的 “pure” 特性，比如上面的代码中只有 <code class="language-text">app.fold(x =&gt; x)</code> 是 “no pure” 的，其他部分都是 “pure” </li>
<li>类似于上一章中的错误集中管理，可以通过 <code class="language-text">LazyBox</code> 来把副作用集中管理，如果在项目中不断的扩大 “pure” 的部分，我们甚至可以把不纯的代码推到代码的边缘，保证核心部分的 “pure” 和 “referential transparency” </li>
</ul>
<blockquote>
<p>LazyBox 也和 Rxjs 中的 <code class="language-text">Observable</code> 有很多相似之处，两者都是惰性的，在 <code class="language-text">subscribe</code> 之前，<code class="language-text">Observable</code> 也不会推送数据。</p>
</blockquote>
<blockquote>
<p>此处请思考下 React 中的 <code class="language-text">useEffect</code> 以及 Redux 中的 <code class="language-text">reducer</code> ，<code class="language-text">action</code> 分离的设计理念。</p>
</blockquote>
<h3>应用函子</h3>
<h4>Function in Box</h4>
<p>上一小结，介绍了把函数装入 <code class="language-text">LazyBox</code> 中，放在最后延迟执行，以保障最后大多数代码的 “pure” 特性。</p>
<p>转换下思维，函数可以认为是“惰性的值”，那么我们把这个稍显特殊的值，装入普通的 <code class="language-text">Box</code> ，又会发生什么呢？还是从小学数学开始吧。</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">Box</span> <span class="token operator">=</span> <span class="token parameter">x</span> <span class="token operator">=></span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token function-variable function">map</span><span class="token punctuation">:</span> <span class="token parameter">f</span> <span class="token operator">=></span> <span class="token function">Box</span><span class="token punctuation">(</span><span class="token function">f</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function-variable function">inspect</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Box(</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>x<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">)</span><span class="token template-punctuation string">`</span></span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> <span class="token function-variable function">addOne</span> <span class="token operator">=</span> <span class="token parameter">x</span> <span class="token operator">=></span> x <span class="token operator">+</span> <span class="token number">1</span>
<span class="token function">Box</span><span class="token punctuation">(</span>addOne<span class="token punctuation">)</span> <span class="token comment">// => Box(x => x + 1)</span></code></pre></div>
<blockquote>
<p><code class="language-text">inspect</code> 方法的目的是为了使用 Node.js 中的 <code class="language-text">console.log</code> 隐式的调用它，方便我们查看数据的类型；而这一方法在浏览器中不可行，可以用 <code class="language-text">console.log(String(x))</code> 来代替; Node.js V12 API 有变更，可以采用 <code class="language-text">Symbol.for(&#39;nodejs.util.inspect.custom&#39;)</code> 替代 <code class="language-text">inspect</code></p>
</blockquote>
<p>现在我们得到了一个包裹着函数的 <code class="language-text">Box</code> ，可是我们怎么使用这个函数呢？毕竟 <code class="language-text">Box(x).map</code> 方法都是接收一个函数！继续回到函数 <code class="language-text">addOne</code> 上，我们需要一个数字，传递给 <code class="language-text">addOne</code> ，对吧！所以换句话说就是，我们怎么传递一个数字进去应用这个 <code class="language-text">addOne</code> 函数呢，答案非常简单，继续传递一个被包裹的值，然后 <code class="language-text">map</code> 这个函数 (<code class="language-text">addOne</code>) 不就可以啦! 看代码：</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">Box</span> <span class="token operator">=</span> <span class="token parameter">x</span> <span class="token operator">=></span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token function-variable function">map</span><span class="token punctuation">:</span> <span class="token parameter">f</span> <span class="token operator">=></span> <span class="token function">Box</span><span class="token punctuation">(</span><span class="token function">f</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function-variable function">apply</span><span class="token punctuation">:</span> <span class="token parameter">o</span> <span class="token operator">=></span> o<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function-variable function">flod</span><span class="token punctuation">:</span> <span class="token parameter">f</span> <span class="token operator">=></span> <span class="token function">f</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function-variable function">inspect</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Box(</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>x<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">)</span><span class="token template-punctuation string">`</span></span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token function">Box</span><span class="token punctuation">(</span>addOne<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token function">Box</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// => Box(3)</span></code></pre></div>
<p>看看 Box 神奇的新方法，首先被包裹的值是一个<strong>函数 x</strong> ，然后我们继续传递另一个 <code class="language-text">Box(2)</code> 进去，不就可以使用 <code class="language-text">Box(2)</code> 上的 <code class="language-text">map</code> 方法调用 <code class="language-text">addOne</code> 函数了吗！</p>
<p>现在重新审视一下我们 <code class="language-text">Box(addOne)</code> ，<code class="language-text">Box(1)</code> ，那么这个问题实际上可以归结为：把一个 <code class="language-text">functor</code> 应用到另一个上 <code class="language-text">functor</code> 上，而这也就是 <code class="language-text">Applicative Functor</code> (应用函子)最擅长的操作了，看一下示意图来描述应用函子的操作流程：</p>
<p><img src="https://p1.music.126.net/kfldU46LvUhUaY_QjP6LHw==/109951164712439705.png" alt="Applicative Functor"></p>
<p>所以根据上面的讲解和实例我们可以得出一个结论：先把一个值 <code class="language-text">x</code> 装进 <code class="language-text">Box</code>，然后 <code class="language-text">map</code> 一个函数 <code class="language-text">f</code>  和把函数 <code class="language-text">f</code> 装进 <code class="language-text">Box</code>，然后 <code class="language-text">apply</code> 一个已经已经装进 <code class="language-text">Box</code> 的 <code class="language-text">x</code>，是完全等价的！</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token constant">F</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token constant">F</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ap</span><span class="token punctuation">(</span><span class="token constant">F</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token function">Box</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>addOne<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token function">Box</span><span class="token punctuation">(</span>addOne<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token function">Box</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment">// => Box(3)</span></code></pre></div>
<blockquote>
<p>根据<a href="https://github.com/fantasyland/fantasy-land#applicative">规范</a>，apply 方法后面我们会简写为<code class="language-text">ap</code>!</p>
</blockquote>
<blockquote>
<p><code class="language-text">Applicative functor (应用函子)</code> 也是函数式编程中一大堆“故弄玄虚”的概念中唯一的比较“名副其实”的了，想想 <code class="language-text">Functor(函子)</code></p>
</blockquote>
<h4>应用函子与函数柯里化</h4>
<p>在继续学习函数柯里化之前，先复习一下中学数学中的高斯消元法：设函数 <code class="language-text">f(x,y) = x + y</code>，在 <code class="language-text">y = 1</code> 的时候，函数可以修改为 <code class="language-text">f(x) = x + 1</code> 。基本思路就是把二元变成一元，同理我们可以把三元函数降元为二元，甚至把多元函数降元为一元函数。   </p>
<p>那么我们可以在一定程度上认为函数求值的过程，就是就是函数消元的过程，当所有的元都被消完之后，那么就可以求的函数值。</p>
<p>数学中的高斯消元法和函数式编程中的“柯里化”是有点类似的，所谓函数柯里化就是把一个接收多个参数的函数，转换为一次接收一个参数，直到收到全部参数之后，进行函数调用(计算函数值)，看例子：</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">add</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span> y</span><span class="token punctuation">)</span> <span class="token operator">=></span> x <span class="token operator">+</span> y
<span class="token keyword">const</span> <span class="token function-variable function">curriedAdd</span> <span class="token operator">=</span> <span class="token parameter">x</span> <span class="token operator">=></span> <span class="token parameter">y</span> <span class="token operator">=></span> x <span class="token operator">+</span> y</code></pre></div>
<p>好了，简单理解了函数柯里化的概念之后，继续往前走一步，思考一下，如果现在有两个「被包裹的值」，怎么把一个函数应用上去呢？举个例子：</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">add</span> <span class="token operator">=</span> <span class="token parameter">x</span> <span class="token operator">=></span> <span class="token parameter">y</span> <span class="token operator">=></span> x <span class="token operator">+</span> y

<span class="token function">add</span><span class="token punctuation">(</span><span class="token function">Box</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token function">Box</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre></div>
<p>上面的方案明显是走不通的，我们没办法直接把  <code class="language-text">Box(1)</code> 和 <code class="language-text">Box(2)</code> 相加，他们都在盒子里; </p>
<p>可是我们的需求不就是把 <code class="language-text">Box(1)</code> ，<code class="language-text">Box(2)</code>，<code class="language-text">add</code> 三者互相应用一下，想要得到最后的结果 <code class="language-text">Box(3)</code>。</p>
<p>从第一章开始，我们的函数运算都是在 Box 的“保护”下进行的，现在不妨也把 <code class="language-text">add</code> 函数包装进 Box 中，不就得到了一个应用函子 <code class="language-text">Box(add)</code>，然后继续 “apply” 其他的函子了吗？</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token function">Box</span><span class="token punctuation">(</span>add<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ap</span><span class="token punctuation">(</span><span class="token function">Box</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment">// => Box(y => 1 + y) (得到另一个应用函子)</span>
<span class="token function">Box</span><span class="token punctuation">(</span>add<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ap</span><span class="token punctuation">(</span><span class="token function">Box</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ap</span><span class="token punctuation">(</span><span class="token function">Box</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment">// => Box(3) (得到最终的结果)</span></code></pre></div>
<p>上面的例子，因为每次 <code class="language-text">apply</code> 一个 <code class="language-text">functor</code> ，相当于把函数降元一次，我们可以得出一个结论，<strong>一个柯里化的函数，有几个参数，我们就可以 apply 几次</strong>。</p>
<blockquote>
<p>每次 apply 之后都会返回包裹新函数的应用函子，换句话说就是：应用多个数据到多个函数，这和多重循环非常类似。</p>
</blockquote>
<h3>应用函子的应用案例</h3>
<p>表单校验是我们日常开发中常见的一个需求，举个具体的例子，假如我们有一个用户注册的表单，我们需要校验用户名，密码两个字段，常见的代码如下：</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">checkUserInfo</span> <span class="token operator">=</span> <span class="token parameter">user</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> name<span class="token punctuation">,</span> pw<span class="token punctuation">,</span> phone <span class="token punctuation">}</span> <span class="token operator">=</span> user
    <span class="token keyword">const</span> errInfo <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token regex">/^[0-9].+$/</span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        errInfo<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">'用户名不能以数字开头'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>pw<span class="token punctuation">.</span>length <span class="token operator">&lt;=</span> <span class="token number">6</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        errInfo<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">'密码长度必须大于6位'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>errInfo<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> errInfo
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> userInfo <span class="token operator">=</span> <span class="token punctuation">{</span>
    name<span class="token punctuation">:</span> <span class="token string">'1Melo'</span><span class="token punctuation">,</span>
    pw<span class="token punctuation">:</span> <span class="token string">'123456'</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> checkRes <span class="token operator">=</span> <span class="token function">checkUserInfo</span><span class="token punctuation">(</span>userInfo<span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>checkRes<span class="token punctuation">)</span>  <span class="token comment">// => [ '用户名不能以数字开头', '密码长度必须大于6位' ]</span></code></pre></div>
<p>这个代码自然没有问题，但是，假如我们要继续添加需要校验的字段(e.g.,电话号码，邮箱)， <code class="language-text">checkUserInfo</code> 函数毫无疑问会越来越庞大，并且如果我们要修改某一个字段的校验规则的话，整个 <code class="language-text">checkUserInfo</code> 函数可能会受到影响，我们需要增加的单元测试工作要更多了。</p>
<p>回想一下第一章中介绍的 Either(Left or Rigth) <code class="language-text">Right</code> 指代正常的分支，<code class="language-text">Left</code> 指代出现异常的分支，他们两者绝不会同时出现，现在我们稍微换个理解方式：<code class="language-text">Right</code> 指代校验通过的分支，<code class="language-text">Left</code> 指代校验不通过的分支。</p>
<p>此时我们继续在第一章 Either 的基础上扩展其他的属性和方法，用来做表单校验的工具：</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">Right</span> <span class="token operator">=</span> <span class="token parameter">x</span> <span class="token operator">=></span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
    x<span class="token punctuation">,</span>
    <span class="token function-variable function">map</span><span class="token punctuation">:</span> <span class="token parameter">f</span> <span class="token operator">=></span> <span class="token function">Right</span><span class="token punctuation">(</span><span class="token function">f</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function-variable function">ap</span><span class="token punctuation">:</span> <span class="token parameter">o</span> <span class="token operator">=></span> o<span class="token punctuation">.</span>isLeft <span class="token operator">?</span> o <span class="token punctuation">:</span> o<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function-variable function">fold</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token parameter">f<span class="token punctuation">,</span> g</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">g</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span>
    isLeft<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    isRight<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token function-variable function">inspect</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Right(</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>x<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">)</span><span class="token template-punctuation string">`</span></span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> <span class="token function-variable function">Left</span> <span class="token operator">=</span> <span class="token parameter">x</span> <span class="token operator">=></span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
    x<span class="token punctuation">,</span>
    <span class="token function-variable function">map</span><span class="token punctuation">:</span> <span class="token parameter">f</span> <span class="token operator">=></span> <span class="token function">Left</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function-variable function">ap</span><span class="token punctuation">:</span> <span class="token parameter">o</span> <span class="token operator">=></span> o<span class="token punctuation">.</span>isLeft <span class="token operator">?</span> <span class="token function">Left</span><span class="token punctuation">(</span>x<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>o<span class="token punctuation">.</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token function">Left</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function-variable function">fold</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token parameter">f<span class="token punctuation">,</span> g</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">f</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span>
    isLeft<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    isRight<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token function-variable function">inspect</span><span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Left(</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>x<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">)</span><span class="token template-punctuation string">`</span></span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre></div>
<p>相对比与原 <code class="language-text">Either</code>，新增了 <code class="language-text">x</code> 属性和 <code class="language-text">ap</code> 方法，其他的属性完全类似，就不做解释了；新增 <code class="language-text">x</code> 属性的原因在于需要记录表单校验的错误信息，这个很好理解，而新增的 <code class="language-text">isLeft</code> ，<code class="language-text">isRight</code> 属性就更简单了，用来区分 <code class="language-text">Left/Right</code> 分支。 </p>
<p>我们仔细看一下新增的 <code class="language-text">ap</code> 方法，先看 <code class="language-text">Right</code> 分支的 <code class="language-text">ap: o =&gt; o.isLeft ? o : o.map(x)</code>，毫无疑问 <code class="language-text">ap</code> 方法接收另一个 <code class="language-text">functor</code> ，如果另一个 <code class="language-text">functor</code> 是 <code class="language-text">Left</code> 的实例，则不需要 <code class="language-text">Right</code> 处理直接返回，如果是 <code class="language-text">Right</code> ，则和平常 <code class="language-text">applicative functor</code> 一样，对 <code class="language-text">o</code> 作为主体进行 <code class="language-text">map</code>。</p>
<p><code class="language-text">Left</code> 分支上的 <code class="language-text">ap: o =&gt; o.Left ? Left(x.concat(o.x)) : Left(x)</code>，如果是 <code class="language-text">Left</code> 的实例，则进行一个“叠加”，实际上就是为了累加错误信息，而如果不是 <code class="language-text">Left</code> 的实例则直接返回原本已经记录的错误信息。</p>
<p>做好了前期的准备工作，我们就可以大刀阔斧的按照函数式的思维(函数组合)来拆分一下 <code class="language-text">checkUserInfo</code> 函数：</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">checkName</span> <span class="token operator">=</span> <span class="token parameter">name</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token operator">/</span><span class="token operator">^</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token operator">-</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token operator">+</span>$<span class="token operator">/</span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token function">Left</span><span class="token punctuation">(</span><span class="token string">'用户名不能以数字开头'</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token function">Right</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> <span class="token function-variable function">checkPW</span> <span class="token operator">=</span> <span class="token parameter">pw</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> pw<span class="token punctuation">.</span>length <span class="token operator">&lt;=</span> <span class="token number">6</span> <span class="token operator">?</span> <span class="token function">Left</span><span class="token punctuation">(</span><span class="token string">'密码长度必须大于6位'</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token function">Right</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre></div>
<p>上面把两个字段校验从一个函数中拆分成了两个函数，更重要的是完全解耦；返回值要么是校验不通过的 <code class="language-text">Left</code> ，要么是校验通过的 <code class="language-text">Right</code> ，所以我们可以理解为现在有了两个 <code class="language-text">Either</code>，只要我们再拥有一个 <strong>被包裹进Either盒子并且柯里化两次的函数</strong> 不就可以让他们互相 apply 了吗？</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> <span class="token constant">R</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'ramda'</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> <span class="token function-variable function">success</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token boolean">true</span>

<span class="token keyword">function</span> <span class="token function">checkUserInfo</span><span class="token punctuation">(</span><span class="token parameter">user</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> name<span class="token punctuation">,</span> pw<span class="token punctuation">,</span> phone <span class="token punctuation">}</span> <span class="token operator">=</span> user
    <span class="token comment">// 2 是因为我们需要 `ap` 2 次。</span>
    <span class="token keyword">const</span> returnSuccess <span class="token operator">=</span> <span class="token constant">R</span><span class="token punctuation">.</span><span class="token function">curryN</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> success<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token function">Right</span><span class="token punctuation">(</span>returnSuccess<span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">ap</span><span class="token punctuation">(</span><span class="token function">checkName</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">ap</span><span class="token punctuation">(</span><span class="token function">checkPW</span><span class="token punctuation">(</span>pw<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> checkRes <span class="token operator">=</span> <span class="token function">checkUserInfo</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token punctuation">:</span> <span class="token string">'1Melo'</span><span class="token punctuation">,</span> pw<span class="token punctuation">:</span> <span class="token string">'123456'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>checkRes<span class="token punctuation">)</span> <span class="token comment">// => Left(用户名不能以数字开头密码长度必须大于6位)</span>

<span class="token keyword">const</span> checkRes2 <span class="token operator">=</span> <span class="token function">checkUserInfo</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token punctuation">:</span> <span class="token string">'Melo'</span><span class="token punctuation">,</span> pw<span class="token punctuation">:</span> <span class="token string">'1234567'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>checkRes2<span class="token punctuation">)</span> <span class="token comment">// => Right(true)</span></code></pre></div>
<p>现在 <code class="language-text">checkUserInfo</code> 函数的返回值是一个 Either(Left or Righr) 函子，具体后面就可以继续使用 <code class="language-text">fold</code> 函数，展示校验不通过弹窗或者进行下一步的表单提交了。</p>
<blockquote>
<p>关于校验参数使用 <a href="https://codurance.com/2018/01/11/applicatives-validation/">Validation</a> 函子更合适 ，这里为了聚焦讲解 Applicative Functor 理念这条主干线，就不再继续引入新概念了。</p>
</blockquote>
<h3>PointFree风格</h3>
<p>上面举例说明的 <code class="language-text">checkUserInfo</code> 函数，需要 <code class="language-text">ap</code> 两次，感觉有点繁琐(想想如果我们需要校验更多的字段呢？)，我们可以抽象出一个 point-free 风格的函数来完成上述操作：</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">apply2</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token constant">T</span><span class="token punctuation">,</span> g<span class="token punctuation">,</span> funtor1<span class="token punctuation">,</span> functor2</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token constant">T</span><span class="token punctuation">(</span>g<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ap</span><span class="token punctuation">(</span>funtor1<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ap</span><span class="token punctuation">(</span>functor2<span class="token punctuation">)</span>

<span class="token keyword">function</span> <span class="token function">checkUserInfo</span><span class="token punctuation">(</span><span class="token parameter">user</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> name<span class="token punctuation">,</span> pw<span class="token punctuation">,</span> phone <span class="token punctuation">}</span> <span class="token operator">=</span> user
    <span class="token keyword">const</span> returnSuccess <span class="token operator">=</span> <span class="token constant">R</span><span class="token punctuation">.</span><span class="token function">curryN</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> success<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token function">apply2</span><span class="token punctuation">(</span>Right<span class="token punctuation">,</span> returnSuccess<span class="token punctuation">,</span> <span class="token function">checkName</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">checkPW</span><span class="token punctuation">(</span>pw<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre></div>
<p><code class="language-text">apply2</code> 函数的参数特别多，尤其是需要传递 <code class="language-text">T</code> 这个不确定的容器，用来把普通函数 <code class="language-text">g</code> 装进盒子里。</p>
<blockquote>
<p>把一个“值”(任意合法类型，当然包括函数)，装进容器中 (Box or Context) 中有一个统一的方法叫 <code class="language-text">of</code> ，而这个过程被称为 <code class="language-text">lift</code> ，意为提升：即把一个值提升到一个上下文中。</p>
</blockquote>
<p>再回头看看前面介绍的：<code class="language-text">Box(addOne).ap(Box(2))</code> 和 <code class="language-text">Box(2).map(addOne)</code> 从结果 (<code class="language-text">Box(3)</code>) 上来看是一样。也就说执行 map 操作 (<code class="language-text">map(addOne)</code>)等同于先执行 of (<code class="language-text">Box(addOne)</code>)，然后执行 ap (<code class="language-text">ap(Box(2))</code>)，用公式表达就是：</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token constant">F</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ap</span><span class="token punctuation">(</span><span class="token constant">F</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token constant">F</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span></code></pre></div>
<p>套用公式，我们可以修改简化 <code class="language-text">apply2</code>  函数体中的 <code class="language-text">T(g).ap(funtor1)</code> 为 <code class="language-text">funtor1.map(g)</code> ，看下面的对比：</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">apply2</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token constant">T</span><span class="token punctuation">,</span> g<span class="token punctuation">,</span> funtor1<span class="token punctuation">,</span> functor2</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token constant">T</span><span class="token punctuation">(</span>g<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ap</span><span class="token punctuation">(</span>funtor1<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ap</span><span class="token punctuation">(</span>functor2<span class="token punctuation">)</span>

<span class="token keyword">const</span> <span class="token function-variable function">liftA2</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">g<span class="token punctuation">,</span> funtor1<span class="token punctuation">,</span> functor2</span><span class="token punctuation">)</span> <span class="token operator">=></span> funtor1<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>g<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ap</span><span class="token punctuation">(</span>functor2<span class="token punctuation">)</span></code></pre></div>
<p>看到了上面的关键点了吗？上面的 <code class="language-text">liftA2</code> 函数中不再耦合于 “T” 这个特定类型的盒子，这样更加的通用灵活。</p>
<p>按照上面的理论，可以改写 <code class="language-text">checkUserInfo</code> 函数为：</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">checkUserInfo</span><span class="token punctuation">(</span><span class="token parameter">user</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> name<span class="token punctuation">,</span> pw<span class="token punctuation">,</span> phone <span class="token punctuation">}</span> <span class="token operator">=</span> user
    <span class="token keyword">const</span> returnSuccess <span class="token operator">=</span> <span class="token constant">R</span><span class="token punctuation">.</span><span class="token function">curryN</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> success<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> <span class="token function">liftA2</span><span class="token punctuation">(</span>returnSuccess<span class="token punctuation">,</span> <span class="token function">checkName</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">checkPW</span><span class="token punctuation">(</span>pw<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre></div>
<p>现在再假设一下我们新增了需要校验的第三个字段“手机号码”，那完全可以扩展 liftA2 函数为 liftA3，liftA4 等等:</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> <span class="token function-variable function">liftA3</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">g<span class="token punctuation">,</span> funtor1<span class="token punctuation">,</span> functor2<span class="token punctuation">,</span> functor3</span><span class="token punctuation">)</span> <span class="token operator">=></span> funtor1<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>g<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ap</span><span class="token punctuation">(</span>functor2<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ap</span><span class="token punctuation">(</span>functor3<span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token function-variable function">liftA4</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">g<span class="token punctuation">,</span> funtor1<span class="token punctuation">,</span> functor2<span class="token punctuation">,</span> functor3<span class="token punctuation">,</span> functor4</span><span class="token punctuation">)</span> <span class="token operator">=></span> funtor1<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>g<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ap</span><span class="token punctuation">(</span>functor2<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ap</span><span class="token punctuation">(</span>functor3<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ap</span><span class="token punctuation">(</span>functor4<span class="token punctuation">)</span></code></pre></div>
<blockquote>
<p>刚开始可能会觉得 <code class="language-text">liftA2-3-4</code> 看起来又丑又没必要；这种写法的意义在于：固定参数数量，一般会在函数式的 lib 中提供，不用自己手动去写这些代码。</p>
</blockquote>
<h3>Applicative Functor 和 Functor 的区别和联系</h3>
<p>根据  <code class="language-text">F(f).ap(F(x)) == F(x).map(f)</code>，我们可以得出一个结论，假如一个盒子 (Box) ，实现了 <code class="language-text">ap</code> 方法，那么我们一定可以利用 <code class="language-text">ap</code> 方法推导出一个 <code class="language-text">map</code> 方法，如果拥有了 <code class="language-text">map</code> 方法，那它就是一个 <code class="language-text">Functor</code> ，所以我们也可以认为 <code class="language-text">Applicative</code> 是 <code class="language-text">Functor</code> 的拓展，比 <code class="language-text">Functor</code> 更强大。</p>
<p>那么强大在何处呢？<code class="language-text">Functor</code> 只能映射一个接收单个参数的函数(e.g., <code class="language-text">x =&gt; y</code>)，如果我们想把接收多个参数的函数(e.g., <code class="language-text">x =&gt; y =&gt; z</code>)应用到多个值上，则是 <code class="language-text">Applicative</code> 的舞台了，想想 <code class="language-text">checkUserInfo</code> 的例子。</p>
<blockquote>
<p>毫无疑问，Applicative Funtor 可以 <code class="language-text">apply</code> 多次（当然包括一次），那么如果函数只有一个参数的情况下，则可以认为 <code class="language-text">map</code> 和 <code class="language-text">apply</code> 是等效的，换句话说：<code class="language-text">map</code> 相当于 <code class="language-text">apply</code> 一次。</p>
</blockquote>
<p>上面是实际应用中的对比，从抽象的数学层面来对比：</p>
<ul>
<li>Functor: 应用一个函数到包裹的值：<code class="language-text">Box(1).map(x =&gt; x+1)</code>.</li>
<li>Applicative: 应用一个包裹的函数到包裹的值：<code class="language-text">Box(x =&gt; x+1).ap(Box(1))</code>。</li>
</ul>
<p><img src="https://p1.music.126.net/qnIolKU9yLB9tH7onLbj7w==/109951164719087429.png" alt="applicative vs functor"></p>
<h3>总结与计划</h3>
<p>我们从纯函数与副作用的概念入手介绍了 <code class="language-text">LazyBox</code> (惰性求值)的概念，从而引入了把函数这个“特殊的值”装进 Box 中，以及怎么 apply 这个“盒子中的函数”，然后介绍了函数柯里化与应用函子的关系(被装进盒子里的函数必须是柯里化的函数)；然后使用使用扩展后的 <code class="language-text">Either</code> 来做表单校验，解耦合函数，最后介绍了使用 point-free 风格来编写链式调用。</p>
<h4>计划</h4>
<p>到目前为止，我们所讨论的问题都是同步的问题，但是在 Javascript 的世界中 90% 的代码都是异步，可以说异步才是 JavaScript 世界的主流，谁能更优雅的解决异步的问题，谁就是  JavaScript 中的大明星，从 <code class="language-text">callback</code> ，到 <code class="language-text">Promise</code> ，再到 <code class="language-text">async await</code> ，那么在函数式编程中异步又该如何解决呢，下一章我们将会介绍一个重量级的概念 <code class="language-text">Monad</code> 以及<code class="language-text">异步函数的组合</code>。   </p>
<p>参考资料与引用文章：   </p>
<ul>
<li><a href="https://medium.com/axiomzenteam/functor-applicative-and-why-8a08f1048d3d">Functor, Applicative, and Why</a>   </li>
<li><a href="https://stackoverflow.com/questions/46752031/what-is-my-applicative-functor-not-working-with-ramdas-ap">Applicative and list</a>   </li>
<li><a href="https://adit.io/posts/2013-04-17-functors,_applicatives,_and_monads_in_pictures.html">Functors, Applicatives, And Monads In Pictures</a>     </li>
<li><a href="https://codurance.com/2018/01/11/applicatives-validation/">Applicative Functors and data validation</a>     </li>
<li><a href="https://hackage.haskell.org/package/validation">validation: A data-type like Either but with an accumulating Applicative</a>     </li>
<li><a href="https://medium.com/beingprofessional/understanding-functor-and-monad-with-a-bag-of-peanuts-8fa702b3f69e">Understanding Functor and Monad With a Bag of Peanuts</a>     </li>
<li><a href="https://jrsinclair.com/articles/2018/how-to-deal-with-dirty-side-effects-in-your-pure-functional-javascript/">How to deal with dirty side effects in your pure functional javascript</a>    </li>
<li><a href="https://medium.com/free-code-camp/functional-programming-in-js-with-practical-examples-part-2-429d2e8ccc9e">Functional Programming In JavaScript — With Practical Examples</a>     </li>
<li>《JavaScript函数式编程》   </li>
</ul>
<blockquote>
<p>本文发布自 <a href="https://github.com/x-orpheus">网易云音乐大前端团队</a>，文章未经授权禁止任何形式的转载。我们常年招收前端、iOS、Android，如果你准备换工作，又恰好喜欢云音乐，那就加入我们 grp.music-fe(at)corp.netease.com！</p>
</blockquote></section><hr style="margin-bottom:1.625rem"/></article><nav><ul style="display:flex;flex-wrap:wrap;justify-content:space-between;list-style:none;padding:0"><li><a rel="prev" href="/web-track/">← 上一篇</a></li><li><a rel="next" href="/rn-optimize/">下一篇 →</a></li></ul></nav><div id="disqus_thread"></div></main></div></div></div><script>
  
  
  if(true) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'UA-46698359-8', 'auto', {});
      
      
      
      
      
      }</script><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/javascript-functional-programming-functor/";window.webpackCompilationHash="6d9b22b749990bbe4509";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"app":["/app-0c9a63a3aef9e813df5b.js"],"component---node-modules-gatsby-plugin-offline-app-shell-js":["/component---node-modules-gatsby-plugin-offline-app-shell-js-51d272fe0618a2665c13.js"],"component---src-templates-blog-post-js":["/component---src-templates-blog-post-js-788c454dbed28c00f3b8.js"],"component---src-pages-404-js":["/component---src-pages-404-js-e9fc057fd683384561c6.js"],"component---src-pages-index-js":["/component---src-pages-index-js-48dc264068dece189e1b.js"]};/*]]>*/</script><script src="/webpack-runtime-2742ada98d46151d1c6f.js" async=""></script><script src="/commons-8d9941e7328683a5eecb.js" async=""></script><script src="/app-0c9a63a3aef9e813df5b.js" async=""></script><script src="/component---src-templates-blog-post-js-788c454dbed28c00f3b8.js" async=""></script><script src="/styles-b1c08a8a0eed6b686afc.js" async=""></script></body></html>